#!/bin/sh

indent() {
  sed -u 's/^/       /'
}

VERSION=9.0.2
BUILD_DIR=$1

echo "--------> Install qpdf v$VERSION"
echo "Downloading binaries" | indent
cd $BUILD_DIR
wget --quiet "https://github.com/qpdf/qpdf/releases/download/release-qpdf-$VERSION/qpdf-$VERSION-x86_64.AppImage"

echo "Installing binaries" | indent
chmod a+x qpdf-$VERSION-x86_64.AppImage
./qpdf-9.0.2-x86_64.AppImage --appimage-extract

cp squashfs-root/usr/bin/* /usr/local/bin/
cp squashfs-root/usr/lib/* /usr/local/lib/
rm -rf qpdf-*.AppImage squashfs-root

echo "-------> Install qpdf complete"
